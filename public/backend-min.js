$(document).ready(function(){if($(".quicksearch tbody tr").length>0){var c=$(".quicksearch"),b=c.data("quicksearch")=="no_focus"?"":"autoselect",e=c.data("label")?c.data("label"):"Set me with data-label";$(".quicksearch tbody tr").quicksearch({attached:".quicksearch",position:"before",labelText:e,inputText:"",inputClass:b,delay:300})}$(".ajax_confirm").click(function(){var g=confirm($(this).data("confirm_message"));return g});$(".ajax_hide_items").click(function(){$(".items").hide("slow")});$(".toggle_me").hide();$(".toggle_link").click(function(g){$(this).next(".toggle_me").toggle("slow");$(this).toggleClass("current").focus()});$(".ajax_filter_by_me").click(function(){var g=$(this).html().trim(),h=$(".quicksearch input");h.val(g);h.focus()});$(".autoselect").focus().select();$(".tablesorter").tablesorter();$("input[name=i_id]").attr("autocomplete","off");$("a.edit").focusin(function(){$(this).closest("tr").addClass("item_hover")}).focusout(function(){$(this).closest("tr").removeClass("item_hover")}).click(function(){$(this).closest("tr").removeClass("item_hover")});$(".ajax_item").click(function(){window.location.href=$(this).find("a").attr("href")});$(".flash.notice").parent().addClass("notice");$(".edit_bulk").click(function(i){i.preventDefault();i.stopPropagation();var h=$(this).closest("tr"),g="/admin/bulks/"+i.target.dataset.b_id;$.ajax({type:"GET",url:g,beforeSend:function(){h.html('<td colspan="6" class="loading"><img src="/media/loading.gif" alt="Cargando..." /></td>')},success:function(j){h.html(j);$("[autofocus]").focus().select()},error:function(){$("#ajax_panel").html('<p class="error"><strong>Oops!</strong> Proba denuevo.</p>')}})});$("form").on("keyup","select[name=b_status]",function(g){if(g.keyCode==13){$(this).closest("form").submit()}});$("form").on("keyup","#ajax_product_buy_cost",function(g){f()});$("#ajax_product_price").on({focus:function(g){exact_price=document.getElementById("ajax_product_exact_price");original_exact_price=exact_price.value;original_price=this.value},keyup:function(g){f();if(parseFloat(this.value.replace(/[\,]/g,"."))!=Number(this.value.replace(/[\,]/g,"."))){this.value=original_price;exact_price.value=original_exact_price}else{if(this.value.length>0&&parseFloat(this.value.replace(/[\,]/g,"."))==Number(this.value.replace(/[\,]/g,"."))&&original_price!=this.value){exact_price.value=this.value}}}});function a(g){return Number(g.replace(/[\,]/g,"."))}function f(){buy_cost=document.getElementById("ajax_product_buy_cost");parts_cost=document.getElementById("ajax_product_parts_cost");materials_cost=document.getElementById("ajax_product_materials_cost");sale_cost=document.getElementById("ajax_product_sale_cost");ideal_markup=document.getElementById("ajax_product_ideal_markup");real_markup=document.getElementById("ajax_product_real_markup");price=document.getElementById("ajax_product_price");real_markup.value=a(price.value)/(a(buy_cost.value)+a(parts_cost.value)+a(materials_cost.value));if(ideal_markup.value==""||ideal_markup.value==0||ideal_markup.value==Infinity||ideal_markup.value==NaN){ideal_markup.value=real_markup.value}sale_cost.value=a(buy_cost.value)+a(parts_cost.value)+a(materials_cost.value)}$("form").on("keyup","input[type=tel].number",function(g){this.value=this.value.replace(/[^0-9\.\,\-]/g,"");if(this.classList.contains("positive")){this.value=this.value.replace(/[\-]/g,"")}});$("#ajax_label_selector").bind("keypress",function(g){if(g.keyCode===13){return d()}});function d(){var g=$("#ajax_label_selector").val();if(g!==""){$("#prod_list_selector").toggle("slow");$("#finish_packaging").toggle("slow");$("#ajax_selected_label").val(g.trim());$("#product_selector").focus()}return false}$(".ajax_product_selector").click(function(){$("#product_selector").val($(this).find("td").html().trim());$("#product_selector").closest("form").submit()});$(".ajax_void_item").click(function(l){l.preventDefault();l.stopPropagation();var i=confirm($(this).data("confirm_message"));if(i==false){return false}var k=$(".ajax_response");var g=$(this).closest("form").attr("action");var h=$(this).siblings("input[name=csrf]").attr("value");var j=$(this).siblings("input[name=i_id]").attr("value");$.ajax({type:"POST",url:g,data:{csrf:h},beforeSend:function(){k.html('<div class="loading"><img src="/media/loading.gif" alt="Cargando..." /></div>')},success:function(q){$(".flash").hide("slow");k.html(q);var p=$("td:contains("+j+")");p.parent("tr").hide("slow");var n=p.closest("table").find(".counter");var m=n.html().trim();var o=parseInt(m,10);n.html(m.replace(o,o-1));$("[autofocus]").focus().select()},error:function(){k.html('<p class="error"><strong>Oops!</strong> Proba denuevo.</p>')}})})});